<%=
  primer_form_with(
    model: provider,
    id: "saml-providers-edit-form",
    url: import_metadata_saml_provider_path(provider),
    data: {
      controller: "show-when-value-selected"
    },
    method: :post,
  ) do |form|
    flex_layout do |flex|
      flex.with_row do
        render(Primer::Beta::Text.new(tag: :p, mb: 4, font_size: :small)) do
          t("saml.providers.section_texts.metadata_form")
        end
      end

      flex.with_row do
        render(Saml::Providers::MetadataOptionsForm.new(form, provider:))
      end

      flex.with_row(
        mt: 2,
        hidden: provider.metadata_url.blank?,
        data: { value: :url, 'show-when-value-selected-target': "effect" }
      ) do
        render(Saml::Providers::MetadataUrlForm.new(form, provider:))
      end

      flex.with_row(
        mt: 2,
        hidden: provider.metadata_xml.blank?,
        data: { value: :xml, 'show-when-value-selected-target': "effect" }
      ) do
        render(Saml::Providers::MetadataXmlForm.new(form, provider:))
      end

      flex.with_row(mt: 4) do
        render(Saml::Providers::SubmitOrCancelForm.new(form,
                                                       provider:,
                                                       state: :metadata))
      end
    end
  end
%>
